MODULE Stats;
   IMPORT Texts, Oberon;
   TYPE
     Stat* = POINTER TO StatRec;
     StatRec *= RECORD 
       count: LONGINT;
       total: REAL;
     END;

   PROCEDURE (s: Stat) Add* (REAL val);
   VAR this: Stat;
   BEGIN this := s;
     this.total := this.total + val;
     this.count := this.count + 1;
   END Add;

   PROCEDURE (s: Stat) Reset*;
   VAR this: Stat;
   BEGIN this := s;
     this.total := 0.0;  
     this.count := 0;
   END Reset;

   PROCEDURE (s: Stat) IsValid*: BOOLEAN;
   VAR this: Stat;
   BEGIN this := s;
     RETURN (this.count > 0);
   END Reset;


   PROCEDURE (s: Stat) Average*: REAL;
   VAR this: Stat;
   BEGIN this := s;
     IF this.IsValid^() THEN
       RETURN 0.0
     ELSE
       RETURN (this.total / this.count)
   END Average;

END Stats;
